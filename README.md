medusa - ստեկային մեքենա
========================

Սա ստեկային մեքենայի էմուլյատոր է, որը ես պատրաստվել է «Կոմպիլյատորների հիմնահարցեր» դասընթացում օգտագործելու համար։

medusa մեքենան նկարագրված է որպես մի ստրուկտուրա, որի `program` զանգվածը պարունակում է կատարվող ծրագիրը, `memory` զանգվածը ստեկն է, իսկ ռեգիստրների `R` զանգվածում պահվում են `IP` - հրամանների ցուցիչ, `SP` - ստեկի ցուցիչ և `FP` - ստեկի կադրի ցուցիչ ռեգիստրների արժեքները։

````c
struct machine {
	struct instruction* program[SIZE];
	int memory[SIZE];
	int R[3];
};
````

Մեքենայի ամեն մի հրամանը `instruction` ստրուկտուրայի նմուշ է, որի `opcode` դաշտը հրամանի կոդն է, իսկ `argument` դաշտը՝ հրամանի արգումենտը։ `PUSHA` և `POPA` հրամանների դեպքում `argument`-ի առաջին երկու բիթերում պահվում է ռեգիստրի համարը։ Մեքենայի հրամանների կոդերի բոլոր հնարավոր արժեքները թվարկված են `operation` `enum`-ի մեջ։

````c
struct instruction {
	enum operation opcode;
	int argument;
};
````

Հրամանների ստորև բերված նկարագրություններում _number_-ը նշանով ամբողջ թիվ է, `R`-ը ռեգիստր է, `D`-ն առանց նշանի ամբողջ թիվ է, _label_-ը առանց նշանի ամբողջ թիվ է, որը կատարում է նշիչի դեր։

1. `NOP` ― ոչինչ չի անում։
2. `HALT` ― ավարտում է մեքենայի աշխատանքը։
3. `PUSHC` _number_ ― ստեկում ավելացնում է տրված _number_ հաստատունը։
4. `PUSHA` _R_(+,-)_D_ ― ստեկում ավելացնում հիշողության R+D հասցեով արժեքը։
5. `PUSHR` _R_ ― ստեկում ավելացնում է R ռեգիստրի արժեքը։
6. `POPA` _R_(+,-)_D_ ― ստեկից հեռացնում է գագաթի տարրը և գրում հիշողության R+D հասցեում։
7. `POPR` _R_ ― հեռացնում է ստեկի գագաթի տարրը և վերագրում է R ռեգիստրին։
8. `DUP` ― կրկնում է ստեկի գագաթի տարրը։
9. `EXCH` ― տեղերով փոխում է ստեկի գագաթի երկու տարրերը։
10. `IN` ― stdin-ից կարդում է ամբողջ թիվ և գրում ստեկում։
11. `OUT` ― stdout-ին արտածում է ստեկի գագաթի տարրը։
12. `LABEL` _label_ ― (փսևդոհրաման է) հաջորդ հրամանին է կապում _label_ նշիչը։
13. `JUMP` _label_ ― առանց պայմանի անցում _label_ նշիչին։
14. `JZ` _label_ ― անցում _label_ նշիչին, եթե ստեկի գագաթում 0 է։
15. `JNZ` _label_ ― անցում _label_ նշիչին, եթե ստեկի գագաթում 0 չէ։
16. `EQ`, `NE`, `GT`, `GE`, `LT`, `LE` հրամանները ստեկից վերցնում են գագաթի երկու տարրերը, դրանց հետ կատարում են համապատասխանաբար `=`, `<>`, `>`, `>=`, `<`, `<=` գործողություններից մեկը և արդյունքը գրում են ստեկի գագաթում։
17. `NOT`, `AND`, `OR` ― տրամաբանական ժխտման, կոնյունկցիայի և դիզյունկցիայի հրամանենրը։
18. `NEG`, `ADD`, `SUB`, `MUL`, `DIV`, `MOD` հրամանները կատարում են թվամաբանական գործողությունները։


Շարահյուսական և նիշային վերլուծությունը
---------------------------------------